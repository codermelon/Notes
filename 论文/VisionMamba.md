# 1. Abstract

- Mamba深度学习模型在长序列建模中显示出巨大的潜力
- 纯粹基于ssm构建高效和通用的视觉主干是一个吸引人的方向
- 本文提出了一种新的基于双向曼巴块(bidirectional Mamba blocks, Vim)的通用视觉主干，该主干利用位置嵌入对图像序列进行标记，并利用双向状态空间模型对视觉表征进行压缩

# 2. Introduction

- 受Mamba在语言建模方面的成功启发，我们也可以将这种成功从语言转移到视觉上，即利用先进的SSM方法设计一个通用的、高效的视觉主干。
- Mamba有两个挑战，即单向建模和缺乏位置意识
- 为了解决这些挑战，我们提出了视觉曼巴(Vim)模型，该模型结合了用于数据依赖的全局视觉上下文建模的双向ssm和用于位置感知视觉识别的位置嵌入
  - 我们首先将输入图像分割成小块，并将它们作为向量线性投影到Vim上。将图像块作为Vim块中的序列数据，利用所提出的双向选择状态空间有效地压缩了视觉表示。此外，Vim块中的位置嵌入提供了对空间信息的感知，使Vim在密集预测任务中具有更强的鲁棒性。

# 3. Method

![image-20240218113848143](https://pj-typora.oss-cn-shanghai.aliyuncs.com/image-20240218113848143.png)

## 3.1 Preliminaries 介绍 SSM模型

状态空间模型（SSM）是一种强大的建模工具，用于描述动态系统的时间序列数据。它将系统的行为建模为一组线性方程，通过隐含状态（隐藏状态）和观察状态来表示。在SSM中，隐含状态代表系统的内部状态，通常无法直接观察，而观察状态是系统产生的可测量的输出。

一个生动的例子是使用SSM来预测和分析一辆车的位置和速度。在这个例子中，车辆的真实位置和速度是隐含状态，因为我们无法直接知晓每一刻车辆的精确位置和速度（尤其是考虑到可能存在的测量误差）。我们可以通过GPS或其他传感器得到有关车辆位置的观察数据，但这些数据可能由于各种原因（如信号遮挡、传感器精度限制等）而不完全准确。

在这种情况下，SSM可以用来：

1. **预测**：基于过去的状态（例如，车辆之前的位置和速度）和当前的观察（例如，通过GPS获得的位置信息），预测车辆的未来状态。
2. **滤波**：结合历史数据和新的观察结果，估计车辆的当前状态。这对于处理噪声数据和不准确的测量特别有用。



## 3.2 Vision Mamba

首先，将2D图像转换为平铺的2D补丁，并通过线性投影和位置嵌入将它们转换为向量。接着，利用Vim编码器处理这些令牌序列，并通过多层感知器（MLP）头部进行最终预测。Vim块结合了双向序列建模，通过正向和反向处理输入令牌序列，并通过SSM操作和线性转换进行处理。



## 3.3 Vim Block

Vim Block部分主要描述了一个为视觉任务设计的Vim块，该块采用双向序列模型来处理输入的序列数据。首先，它通过正规化输入序列，并通过线性投影将输入转换和处理，接着使用1-D卷积和线性投影转换参数，最后通过状态空间模型(SSM)计算输出。输出通过双向处理得到，再经过门控和组合，加上输入序列产生最终的输出序列。这种设计使得Vim块能够有效处理需要空间意识的视觉任务。



## 3.4 Architecture Details

3.4节主要总结了该架构的超参数设置，包括：

- L：块的数量
- D：隐藏状态维度
- E：扩展状态维度
- N：SSM维度

遵循ViT和DeiT的设定，首先使用16×16的核大小投影层获取非重叠的补丁嵌入的一维序列。然后直接堆叠L个Vim块。默认情况下，块的数量L设置为24，SSM维度N为16。为了与DeiT系列的模型大小对齐，将隐藏状态维度D设置为192，扩展状态维度E为384，以适应tiny-size变体。对于small-size变体，D设置为384，E设置为768。
